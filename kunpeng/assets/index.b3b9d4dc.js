var U=Object.defineProperty;var R=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var B=(e,t,a)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,T=(e,t)=>{for(var a in t||(t={}))G.call(t,a)&&B(e,a,t[a]);if(R)for(var a of R(t))I.call(t,a)&&B(e,a,t[a]);return e};var g=(e,t,a)=>new Promise((c,u)=>{var h=l=>{try{r(a.next(l))}catch(f){u(f)}},A=l=>{try{r(a.throw(l))}catch(f){u(f)}},r=l=>l.done?c(l.value):Promise.resolve(l.value).then(h,A);r((a=a.apply(e,t)).next())});import{T as V,B as W}from"./TableAction.2eb938ab.js";import{B as O}from"./BasicForm.2b6c57bc.js";import{u as K}from"./useForm.3f80a604.js";import{h as x}from"./index.ea60a1e6.js";import{r as Q}from"./index.29b8470e.js";import{s as m,aF as $,d as H,a0 as X,e as C,bf as j,i as J,o as v,X as w,R as k,u as y,Q as E,be as L,$ as Y,ad as Z,av as z}from"./vendor.192340e4.js";import"./sortable.esm.81321d43.js";import"./useDesignSetting.0219bcf0.js";import"./propTypes.13e00d90.js";import"./componentSetting.ed658149.js";import"./index.esm.7227c09d.js";function ee(e,t){return x.request({url:"/kafka/kafka/query/"+t,method:"GET",params:e})}function te(){return x.request({url:"/kafka/service/name/list",method:"GET"})}const D=[{label:"TRACE",value:"TRACE",meta:{tagType:"primary"}},{label:"DEBUG",value:"DEBUG",meta:{tagType:"success"}},{label:"INFO",value:"INFO",meta:{tagType:"info"}},{label:"WARN",value:"WARN",meta:{tagType:"warning"}},{label:"ERROR",value:"ERROR",meta:{tagType:"error"}}],ae=e=>{const t=D.find(u=>u.value===e),a=(t==null?void 0:t.meta.tagType)||"default",c=t==null?void 0:t.label;return m($,{type:a},{default:()=>c})},ne=[{title:"id",key:"id",width:200},{title:"\u5FAE\u670D\u52A1\u540D\u79F0",key:"index",width:120},{title:"\u65F6\u95F4",width:140,align:"center",key:"sourceAsMap[date]",render(e){return Q(e.sourceAsMap.date)}},{title:"\u6587\u4EF6",key:"sourceAsMap[file]",render(e){return m("span",null,{default:()=>e.sourceAsMap.file})}},{title:"\u7C7B",key:"sourceAsMap[class]",align:"center",width:400,render(e){return m("span",null,{default:()=>e.sourceAsMap.class})}},{title:"thread",key:"sourceAsMap[thread]",width:80,render(e){return m("span",null,{default:()=>e.sourceAsMap.thread})}},{title:"\u4FE1\u606F",key:"sourceAsMap[message]",align:"center",width:400,render(e){return m("span",null,{default:()=>e.sourceAsMap.message})}},{title:"\u7B49\u7EA7",key:"sourceAsMap[level]",align:"center",render(e){return ae(e.sourceAsMap.level)}}],oe=L("\u5237\u65B0\u6570\u636E"),he=H({setup(e){const t=X(),a=C(0),c=C(),u={field:"index",component:"NSelect",label:"\u5FAE\u670D\u52A1\u540D\u79F0",componentProps:{options:[],clearable:!1}},h=[{filed:"message",component:"NInput",label:"\u641C\u7D22"},{field:"id",component:"NInput",label:"id",componentProps:{placeholder:"\u65E5\u5FD7\u7684id"}},u,{field:"level",component:"NSelect",label:"\u7B49\u7EA7",componentProps:{placeholder:"\u8BF7\u9009\u62E9\u7B49\u7EA7",options:D}},{field:"timeRange",component:"NDatePicker",label:"\u65F6\u95F4\u8303\u56F4",componentProps:{type:"datetimerange"}}],[A,r]=K({gridProps:{cols:"1 s:1 m:2 l:3 xl:4 2xl:4"},labelWidth:80,schemas:h});te().then(n=>g(this,null,function*(){const i=(n||[]).map(o=>{const s=o.split(":");return{label:s[0],value:s[1]}});u.componentProps.options=i,yield r.setProps({gridProps:{cols:"1 s:1 m:2 l:3 xl:4 2xl:4"},labelWidth:80,schemas:h}),a.value++,j(()=>g(this,null,function*(){yield r.setFieldsValue({index:i[0].value}),F()}))}));const l=J({width:200,title:"\u64CD\u4F5C",key:"action",fixed:"right",render(n){return m(V,{style:"button",actions:[{label:"\u5220\u9664",onClick:N.bind(null,n),type:"error"},{label:"\u67E5\u770B\u8BE6\u60C5",onClick:S.bind(null,n),type:"primary"}]})}}),f=i=>g(this,[i],function*({page:n,size:d}){const o=r.getFieldsValue(),s=o.timeRange,p=o.index;delete o.index,s&&(o.fromDateTime=s[0],o.toDateTime=s[1],delete o.timeRange);const{hits:{hits:_,totalHits:{value:b}}}=yield ee(T({page:n,size:d},o),p);return b?{list:_,page:n,pageCount:Math.ceil(b/d),size:d}:{list:[],page:1,pageCount:1}});function M(n){console.log(n)}function F(){c.value.reload()}function N(n){console.log("\u70B9\u51FB\u4E86\u5220\u9664",n),t.info("\u70B9\u51FB\u4E86\u5220\u9664")}function P(){return g(this,null,function*(){F()})}function S(n){var i;window.$dialog.error({title:"\u9519\u8BEF\u8BE6\u60C5",content:(i=n==null?void 0:n.sourceAsMap)==null?void 0:i.message})}function q(n){console.log(n)}return(n,d)=>{const i=Y,o=Z,s=z;return v(),w(s,{bordered:!1,class:"proCard"},{default:k(()=>[(v(),w(y(O),{onRegister:y(A),onSubmit:P,onReset:q,key:a.value},{statusSlot:k(({model:p,field:_})=>[E(i,{value:p[_],"onUpdate:value":b=>p[_]=b},null,8,["value","onUpdate:value"])]),_:1},8,["onRegister"])),E(y(W),{"is-auto-request":!1,columns:y(ne),request:f,"row-key":p=>p.id,ref_key:"actionRef",ref:c,actionColumn:y(l),"onUpdate:checkedRowKeys":M,"scroll-x":1800},{toolbar:k(()=>[E(o,{type:"primary",onClick:F},{default:k(()=>[oe]),_:1})]),_:1},8,["columns","row-key","actionColumn"])]),_:1})}}});export{he as default};
