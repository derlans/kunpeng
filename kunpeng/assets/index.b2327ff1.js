var w=(r,y,n)=>new Promise((g,k)=>{var s=l=>{try{c(n.next(l))}catch(d){k(d)}},h=l=>{try{c(n.throw(l))}catch(d){k(d)}},c=l=>l.done?g(l.value):Promise.resolve(l.value).then(s,h);c((n=n.apply(r,y)).next())});import{s as M,p as q}from"./index.ea60a1e6.js";import{r as T}from"./index.29b8470e.js";import{T as z,B as P}from"./TableAction.2eb938ab.js";import{u as Q}from"./useForm.d81d1de8.js";import{d as X,e as E,i as j,s as G,o as v,c as H,Q as t,R as e,u as o,X as b,V as J,F as K,be as F,ad as L,$ as O,af as W,c2 as Y,ae as Z,ar as ee,a$ as te}from"./vendor.192340e4.js";import"./sortable.esm.81321d43.js";import"./useDesignSetting.0219bcf0.js";import"./propTypes.13e00d90.js";import"./componentSetting.ed658149.js";import"./index.esm.7227c09d.js";function ue(){return[{key:"id",title:"id"},{key:"rolename",title:"\u89D2\u8272\u540D",align:"center"},{key:"code",title:"\u7F16\u7801",align:"center"},{key:"description",title:"\u63CF\u8FF0",align:"center"},{key:"createUser",title:"\u521B\u5EFA\u4EBA",align:"center"},{key:"updateUser",title:"\u66F4\u65B0\u4EBA",align:"center"},{key:"createTime",title:"\u521B\u5EFA\u65F6\u95F4",align:"center",render(r){return T(r.createTime)}},{key:"updateTime",title:"\u66F4\u65B0\u65F6\u95F4",align:"center",render(r){return T(r.updateTime)}}]}const oe=ue(),ne=F("\u5237\u65B0\u6570\u636E"),le=F("\u65B0\u5EFA\u89D2\u8272"),ae=F("\u53D6\u6D88"),se=F("\u65B0\u5EFA"),ie=F("\u66F4\u65B0"),ye=X({setup(r){const y=window.$dialog,n=window.$message,g=E(),k=j({width:200,title:"\u64CD\u4F5C",key:"action",align:"center",fixed:"right",render(_){return G(z,{style:"button",actions:[{label:"\u5220\u9664",onClick:()=>{y.warning({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u5220\u9664\u8BE5\u89D2\u8272\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u4E0D\u786E\u5B9A",onPositiveClick:()=>{s.deleteRole(_.id).then(()=>{n.success("\u5220\u9664\u6210\u529F"),c()}).catch(()=>{n.fail("\u5220\u9664\u5931\u8D25")})}})},type:"warning"},{label:"\u4FEE\u6539",type:"success",onClick:()=>{p.value=B[1],D.setFieldsValue(_,1),m.value=!0}}]})}}),s=M();function h(){return w(this,null,function*(){return yield s.setRoles(),{list:s.roles,page:1,pageCount:1,size:s.roles.length}})}function c(){g.value.reload()}const d=q().getAllAuthNodeTree,m=E(!1),[a,D]=Q({schemas:[{field:"rolename",defaultValue:""},{field:"code",defaultValue:""},{field:"description",defaultValue:""},{field:"authIds",defaultValue:[]}]}),R=[];function V(){}function x(){return w(this,null,function*(){yield s.updateRole(a),n.success("\u66F4\u65B0\u6210\u529F")})}function U(_){a.authIds=_}const B=[{value:0,title:"\u65B0\u5EFA\u89D2\u8272"},{value:1,title:"\u4FEE\u6539\u89D2\u8272"}],p=E(B[0]);return(_,u)=>{const f=L,A=O,C=W,$=Y,N=Z,S=ee,I=te;return v(),H(K,null,[t(o(P),{columns:o(oe),request:h,"row-key":i=>i.id,actionColumn:o(k),"scroll-x":1090,ref_key:"actionRef",ref:g},{toolbar:e(()=>[t(f,{type:"primary",onClick:c,class:"mr-3"},{default:e(()=>[ne]),_:1}),t(f,{type:"success",onClick:u[0]||(u[0]=()=>{p.value=B[0],m.value=!0})},{default:e(()=>[le]),_:1})]),_:1},8,["columns","row-key","actionColumn"]),t(I,{show:m.value,"onUpdate:show":u[4]||(u[4]=i=>m.value=i),"show-icon":!1,preset:"dialog",title:p.value.title},{action:e(()=>[t(S,null,{default:e(()=>[t(f,{onClick:u[3]||(u[3]=()=>m.value=!1)},{default:e(()=>[ae]),_:1}),p.value.value===0?(v(),b(f,{key:0,type:"info",onClick:V},{default:e(()=>[se]),_:1})):p.value.value===1?(v(),b(f,{key:1,type:"success",onClick:x},{default:e(()=>[ie]),_:1})):J("",!0)]),_:1})]),default:e(()=>[t(N,{model:o(a),rules:R,ref:"formRef","label-placement":"left","label-width":80,class:"py-4"},{default:e(()=>[t(C,{label:"\u540D\u5B57",path:"rolename"},{default:e(()=>[t(A,{value:o(a).rolename,"onUpdate:value":u[1]||(u[1]=i=>o(a).rolename=i)},null,8,["value"])]),_:1}),t(C,{label:"\u6807\u8BC6\u7B26",path:"code"},{default:e(()=>[t(A,{value:o(a).code,"onUpdate:value":u[2]||(u[2]=i=>o(a).code=i)},null,8,["value"])]),_:1}),t(C,{label:"\u6388\u6743",path:"authIds"},{default:e(()=>[(v(),b($,{checkable:"",multiple:"",options:o(d),"onUpdate:value":U,"default-value":o(a).authIds,"label-field":"name","key-field":"id",key:1},null,8,["options","default-value"]))]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])],64)}}});export{ye as default};
