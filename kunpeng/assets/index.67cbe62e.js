var B=(e,t,n)=>new Promise((d,r)=>{var y=u=>{try{o(n.next(u))}catch(i){r(i)}},_=u=>{try{o(n.throw(u))}catch(i){r(i)}},o=u=>u.done?d(u.value):Promise.resolve(u.value).then(y,_);o((n=n.apply(e,t)).next())});import{s as T,_ as L,d as E,i as R,o as k,X as q,R as m,a as $,c as w,r as M,bH as P,t as V,u as c,F as U,av as I,e as g,Q as l,be as j,$ as G,ad as H,a$ as X}from"./vendor.192340e4.js";import{r as C}from"./index.29b8470e.js";import{T as O,B as Q}from"./TableAction.2eb938ab.js";import{B as W}from"./BasicForm.2b6c57bc.js";import{u as z}from"./useForm.3f80a604.js";import{_ as J,g as K}from"./SetRole.007d5712.js";import{h as x}from"./index.ea60a1e6.js";import"./sortable.esm.81321d43.js";import"./useDesignSetting.0219bcf0.js";import"./propTypes.13e00d90.js";import"./componentSetting.ed658149.js";import"./index.esm.7227c09d.js";function Y(e,t=" "){return T("span",null,e.join(t))}function Z(){return[{key:"id",title:"id"},{key:"username",title:"\u7528\u6237\u540D",align:"center"},{key:"avatar",title:"\u5934\u50CF",align:"center",render(e){return T(L,{size:"medium",src:e.avatar,round:!0})}},{key:"sysRoles",title:"\u89D2\u8272",align:"center",render(e){return Y(e.sysRoles.map(t=>t.rolename))}},{key:"email",title:"\u90AE\u7BB1",align:"center"},{key:"city",title:"\u57CE\u5E02",align:"center"},{key:"phone",title:"\u7535\u8BDD",align:"center"},{key:"birthday",title:"\u751F\u65E5",align:"center",render(e){if(e.birthday)return C(e.birthday)}},{key:"createTime",title:"\u521B\u5EFA\u65F6\u95F4",align:"center",render(e){return C(e.createTime)}},{key:"updateTime",title:"\u66F4\u65B0\u65F6\u95F4",align:"center",render(e){return C(e.updateTime)}}]}const ee=Z();function te(e){return x.request({url:`/kunpeng/kunpeng/batch/get/${e}`,method:"GET"})}function ne(e,t,n){return x.request({url:`/kunpeng/kunpeng/set/${e}?type=${t}&value=${n}`,method:"POST"})}const D=62;function ue(e){const t=BigInt(e).toString(2).split("").map(n=>parseInt(n)).reverse();return t.length<D&&t.push(...Array(D-t.length).fill(0)),t}const re={class:"flex justify-start flex-wrap"},se=["title","onClick"],oe=$("div",null,null,-1),ae=E({props:{userid:null},setup(e){const t=e,n=R([]);te(t.userid).then(r=>{n.push(...ue(r.value))}).catch(()=>{});function d(r){return B(this,null,function*(){yield ne(t.userid,r,!n[r]),n[r]=n[r]?0:1})}return(r,y)=>{const _=I;return k(),q(_,{title:"\u7F16\u8F91\u9ED1\u540D\u5355\u89C4\u5219",class:"w-96"},{default:m(()=>[$("div",re,[(k(!0),w(U,null,M(c(n),(o,u)=>(k(),w("span",{key:u,class:"border-2 m-2 w-7 h-7 text-center leading-7 cursor-pointer hover:bg-black",style:P({background:o?"#000":"",color:o?"#fff":""}),title:o?"\u70B9\u51FB\u89E3\u7981":"\u70B9\u51FB\u5C01\u7981",onClick:i=>d(u)},V(u),13,se))),128))]),oe]),_:1})}}}),le=j("\u5237\u65B0\u6570\u636E"),Fe=E({setup(e){const t=g(),n=R({width:200,title:"\u64CD\u4F5C",key:"action",align:"center",fixed:"right",render(a){return T(O,{style:"button",actions:[{label:"\u6388\u4E88\u89D2\u8272",type:"success",onClick:()=>{b.value=a,v.value=!0}},{label:"\u9ED1\u540D\u5355\u7F16\u8F91",type:"info",onClick:()=>{u.value=!0,i.value=a.id}}]})}});function d(N){return B(this,arguments,function*({size:a,page:p}){const{username:F=""}=o.getFieldsValue(),{records:f,total:s,current:h}=yield K({current:p,size:a,username:F});return window.users=f,s?{list:f,page:h,pageCount:Math.ceil(s/a),size:a}:{list:[],page:1,pageCount:1}})}function r(){t.value.reload()}const y=[{field:"username",component:"NInput",label:"\u7528\u6237\u540D",componentProps:{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:["blur"]}]}],[_,o]=z({gridProps:{cols:"1 s:1 m:2 l:3 xl:4 2xl:4"},labelWidth:80,schemas:y}),u=g(!1),i=g(""),v=g(!1);let b=g({});function A(a){b.value.sysRoles=a}return(a,p)=>{const N=G,F=H,f=X;return k(),w(U,null,[l(c(W),{onRegister:c(_),onSubmit:r},{statusSlot:m(({model:s,field:h})=>[l(N,{value:s[h],"onUpdate:value":S=>s[h]=S},null,8,["value","onUpdate:value"])]),_:1},8,["onRegister"]),l(c(Q),{columns:c(ee),request:d,"row-key":s=>s.id,actionColumn:c(n),"scroll-x":1800,ref_key:"actionRef",ref:t},{toolbar:m(()=>[l(F,{type:"primary",onClick:r},{default:m(()=>[le]),_:1})]),_:1},8,["columns","row-key","actionColumn"]),l(f,{show:u.value,"onUpdate:show":p[0]||(p[0]=s=>u.value=s)},{default:m(()=>[l(ae,{userid:i.value},null,8,["userid"])]),_:1},8,["show"]),l(f,{show:v.value,"onUpdate:show":p[1]||(p[1]=s=>v.value=s)},{default:m(()=>[l(J,{user:c(b),"onUpdate:sysRoles":A},null,8,["user"])]),_:1},8,["show"])],64)}}});export{Fe as default};
